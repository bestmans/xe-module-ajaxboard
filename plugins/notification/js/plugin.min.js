/*! Copyright (C) 2014 AJAXBOARD. All rights reserved. */!function(e,t){"use strict";e.ajaxboardStorage.connect=!0,e.allowNotification=function(){Notification.requestPermission(function(){t("#permission-description").fadeOut()})},e.denyNotification=function(){var e=new Date;e.setTime(e.getTime()+2592e6),setCookie("notification_denied","Y",e),t("#permission-description").fadeOut()},t(function(){function i(){this.oApp=e.ajaxboard;var i=this,r=[["events.broadcastMessage","before","triggerBroadcastMessage"],["events.insertDocument.detail","before","triggerInsertDocument"],["events.insertComment.detail","before","triggerInsertComment"]];t.each(r,function(e,t){i.oApp.insertTrigger(i,t[0],t[1],i[t[2]])}),"default"==Notification.permission&&"Y"!=getCookie("notification_denied")&&t("#permission-description").fadeIn()}if(i.prototype={triggerBroadcastMessage:function(e){var t=function(e){setTimeout(function(){e.currentTarget.close()},6e3)},i={};i.body=this.strip(e.extra_vars.message),i.tag=NOTIFICATION_ID+":broadcastMessage:"+NOTIFICATION.length,i.icon=NOTIFICATION_ICON,i.onshow=t,NOTIFICATION.push(new Notification(NOTIFICATION_BRO_TITLE,i))},triggerInsertDocument:function(i,r){var o=this.oApp.current_url.setQuery("document_srl",i.target_srl),n=function(){e.focus(),location.href=o},s=function(e){setTimeout(function(){e.currentTarget.close()},2e3)};if(t.inArray(Number(i.module_srl),NOTIFICATION_USER_INFO)>-1){var a={};a.body=this.strip(r.title),a.tag=NOTIFICATION_ID+"insertDocument:"+i.target_srl,a.icon=NOTIFICATION_ICON,a.onclick=n,a.onshow=s,NOTIFICATION.push(new Notification(NOTIFICATION_DOC_TITLE+" #"+r.browser_title,a))}},triggerInsertComment:function(t,i){var r=this.oApp.current_url.setQuery("module","ajaxboard").setQuery("act","procAjaxboardRedirect").setQuery("type","comment").setQuery("comment_srl",t.target_srl),o=function(){e.focus(),location.href=r},n=function(e){setTimeout(function(){e.currentTarget.close()},6e3)};if(this.oApp.member_srl&&this.oApp.member_srl!=t.target_member_srl&&this.oApp.member_srl==t.extra_vars.parent_member_srl){var s={};s.body=this.strip(i.content),s.tag=NOTIFICATION_ID+":insertComment:"+t.target_srl,s.icon=NOTIFICATION_ICON,s.onclick=o,s.onshow=n,NOTIFICATION.push(new Notification(NOTIFICATION_COM_TITLE+" #"+i.browser_title,s))}},strip:function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var i=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(i,function(e,i){return t.indexOf("<"+i.toLowerCase()+">")>-1?e:""})}},"undefined"!=typeof Notification){new i}})}(this,jQuery);
