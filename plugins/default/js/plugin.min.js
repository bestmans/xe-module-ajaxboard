/*! Copyright (C) 2014 AJAXBOARD. All rights reserved. */!function(e,n){"use strict";function t(e){return c.ajax("html",c.current_url,null,null,e)}function r(e){var r=t(e);return r.done(function(e){var t=n("<div>").append(n.parseHTML(e)).find("#comment"),r=t.children(".fbHeader").html(),i=t.children(".fbList").html(),o=t.children(".pagination").html(),a=n("#comment"),c=a.children(".fbHeader"),l=a.children(".fbList"),u=a.children(".pagination");l.length?i||l.remove():c.after(n('<ul class="fbList">')),u.length?o||u.remove():o&&l.after(n('<div class="pagination">')),a.children(".fbHeader").html(r),a.children(".fbList").html(i),a.children(".pagination").html(o)}),r}function i(e){var n=r({cpage:e});return n.done(function(){c.current_url=c.current_url.setQuery("cpage",e)}),n}function o(e){var r=t(e);return r.done(function(e){var t=n("<div>").append(n.parseHTML(e)).find(".board"),r=t.children(".board_list").html(),i=t.children(".list_footer").children(".pagination").html(),o=n(".board"),a=o.children(".board_list"),c=o.children(".list_footer").children(".pagination");c.length?i||c.remove():i&&n(".list_footer").prepend('<div class="pagination">'),a.html(r),o.children(".list_footer").children(".pagination").html(i)}),r}function a(e){var n=o({page:e});return n.done(function(){c.current_url=c.current_url.setQuery("page",e)}),n}var c=e.ajaxboard,l=!1;c.insertTrigger("events.connect","after",function(){if(!l){l=!0;var t=e.completeInsertComment;t&&n.isFunction(t)&&(e.completeInsertComment=function(){c.clearEditor()}),n(".read_footer").on("click",".btnArea [href]",function(){var e=n(this).attr("href");e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));var t=e.getQuery("act"),r=e.getQuery("document_srl"),i=c.current_url.setQuery("act","").setQuery("document_srl","");return"dispBoardDelete"==t?(c.deleteDocument(r,e,function(e){alert(e.message),location.href=i},function(){location.href=i}),!1):void 0}),n("#comment").on("click",".action .delete",function(){var e=n(this).attr("href");e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));var t=e.getQuery("comment_srl");return c.deleteComment(t,e,function(e){alert(e.message)},function(){r()}),!1}).on("click",".pagination [href]",function(){var e=n(this),t=e.attr("href");t.indexOf("#")>-1&&(t=t.substring(0,t.indexOf("#")));var r=t.getQuery("cpage");return i(r>1&&e.hasClass("direction")?"":r),!1}),n(".list_footer").on("click",".pagination [href]",function(){var e=n(this).attr("href");return e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#"))),a(e.getQuery("page")),!1})}}),c.insertTrigger("events.insertComment","before",function(e){n("#comment").length&&(n("#comment_"+e.parent_srl).length||n(".read_body [class*='document_"+e.parent_srl+"']").length)&&r()}),c.insertTrigger("events.deleteComment","before",function(e){n("#comment_"+e.target_srl).length&&r()})}(this,jQuery);
