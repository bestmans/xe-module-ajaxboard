/*! Copyright (C) 2014 AJAXBOARD. All rights reserved. */!function(e,n){"use strict";function t(e){return u.ajax("html",u.current_url,null,null,e)}function r(){if(!n("#clb").length){var t=[];t.push('<div class="hx h3">'),t.push('<h3 id="clb">'+e.xe.lang.cmd_reply+" <em>[1]</em></h3>"),t.push('<button type="button" class="tg tgr" title="open/close"></button>'),t.push("</div>"),n("#skip_co").after(t.join("\n"))}var r=u.current_url,c=r.getQuery("document_srl"),i=r.getQuery("cpage");return loadPage(c,i)}function c(e){var r=t(e);return r.done(function(e){var t=n("<div>").append(n.parseHTML(e)).find(".bd"),r=t.children(".hx").children("h2").html(),c=t.children(".lt").html(),i=t.children(".pn").html(),l=n(".bd"),u=l.children(".hx").children("h2"),o=l.children(".lt"),s=l.children(".pn");u.html(r),o.html(c),s.html(i)}),r}function i(e){var n=c({page:e});return n.done(function(){u.current_url=u.current_url.setQuery("page",e)}),n}function l(){n(".lt").length&&c()}var u=e.ajaxboard,o=!1;u.insertTrigger("clearEditor","after",function(){n("#rText").val("")}),u.insertTrigger("events.connect","after",function(){if(!o){o=!0;var t=e.completeInsertComment;t&&n.isFunction(t)&&(e.completeInsertComment=function(){u.clearEditor()});var c=e.loadPage;c&&n.isFunction(c)&&(e.loadPage=function(e,n){u.current_url=u.current_url.setQuery("document_srl",e).setQuery("cpage",n),c(e,n)}),n(".bd").on("click",".auth .de",function(){var e=n(this),t=e.attr("href");t.indexOf("#")>-1&&(t=t.substring(0,t.indexOf("#")));var c=t.getQuery("comment_srl");return u.deleteComment(c,t,function(e){alert(e.message)},function(){r()}),!1}).on("click",".pn .prev, .pn .next",function(){var e=n(this),t=e.attr("href");t.indexOf("#")>-1&&(t=t.substring(0,t.indexOf("#")));var r=t.getQuery("page");return i(r),!1})}}),u.insertTrigger("events.insertDocument","before",l),u.insertTrigger("events.deleteDocument","before",l),u.insertTrigger("events.insertComment","before",function(e){l(),(n("#cl [class*='comment_"+e.parent_srl+"']").length||n(".co [class*='document_"+e.parent_srl+"']").length)&&r()}),u.insertTrigger("events.deleteComment","before",function(e){l(),n("#cl [class*='comment_"+e.target_srl+"']").length&&r()})}(this,jQuery);
